(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,o(r.key),r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function r(t,e,n){return(e=o(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(e){var n=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===t(n)?n:String(n)}var i=n((function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r(this,"add",(function(t){e._listener.push(t)})),r(this,"remove",(function(t){e._listener=e._listener.filter((function(t){return t!==listener}))})),r(this,"emit",(function(t){e._listener.forEach((function(e){return e(t)}))})),this._listener=[]}));function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,s(r.key),r)}}function u(t,e,n){return(e=s(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t){var e=function(t,e){if("object"!==c(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===c(e)?e:String(e)}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,"onChangeLocalStorageData",new i),u(this,"onChangeTextareaContent",new i),u(this,"onChangeLang",new i),u(this,"onChangeCursorPosition",new i),u(this,"onInitState",new i),this._langIndex=0,this._langMap=["en","ru"],this._textareaContent="",this._textareaRow=[""],this._cursor={line:0,pos:0,number:0},this._keys={},this._activeBtns={},this._lastControl={id:null,time:null},this._activeControls={},this._lastKey=null,this._capsLock=!1}var e,n;return e=t,(n=[{key:"setInitState",value:function(t){var e=t.keys,n=t.langIndex;this._langIndex=n,this._keys=e,this.onInitState.emit({keys:e,lang:this._langMap[n]})}},{key:"cursor",get:function(){return this._cursor},set:function(t){this._cursor=t,this.onChangeCursorPosition.emit({start:this._cursor.number,end:this._cursor.number})}},{key:"textareaRow",get:function(){return this._textareaRow},set:function(t){this._textareaRow=t}},{key:"get",value:function(){return this}},{key:"textareaContent",get:function(){return this._textareaContent},set:function(t){this._textareaContent=t,this.onChangeTextareaContent.emit(this._textareaContent)}},{key:"keys",get:function(){return this._keys},set:function(t){this._keys=t}},{key:"langIndex",get:function(){return this._langIndex},set:function(t){this._langIndex=t,this.onChangeLang.emit(this._langMap[this._langIndex]),this.onChangeLocalStorageData.emit({lang:this._langMap[this.langIndex],textareaContent:this.textareaContent,textareaRow:this.textareaRow,cursor:this.cursor})}},{key:"lang",get:function(){return this._langMap},set:function(t){this._langMap=t}},{key:"getKeyContent",value:function(t){return this._keys[t]||!1}},{key:"activeBtns",get:function(){return this._activeBtns},set:function(t){this._activeBtns=t}},{key:"lastControl",get:function(){return this._lastControl},set:function(t){this._lastControl=t}},{key:"activeControls",get:function(){return this._activeControls},set:function(t){this._activeControls=t}},{key:"lastKey",get:function(){return this._lastKey},set:function(t){this._lastKey=t}},{key:"capsLock",get:function(){return this._capsLock},set:function(t){this._capsLock=t}}])&&a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,h(r.key),r)}}function y(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function b(t,e,n){return(e=h(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h(t){var e=function(t,e){if("object"!==f(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===f(e)?e:String(e)}var d=y((function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),b(this,"getLast",(function(){return e.buffer[e.buffer.length-1]||""})),b(this,"push",(function(t){e.buffer.push(t)})),this.buffer=[]}));function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){x(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,O(r.key),r)}}function x(t,e,n){return(e=O(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O(t){var e=function(t,e){if("object"!==m(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===m(e)?e:String(e)}var C=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),x(this,"prepareTextareaRow",(function(t){return t.split("\n").map((function(t){return"".concat(t,"\n")})).map((function(n){if(n.length<=e.maxRowLength)return n;for(var r=[],o=n;o.length>77;){var i=o.match(/.{1,77}/g)[0].lastIndexOf(" ");-1!==i&&(r.push(o.slice(0,i+1)),o=t.slice(i+1))}return r.push(o),r})).flat()})),x(this,"setCursorPosition",(function(t){e.cursor=w({number:t},e.findCursorPosition(t))})),x(this,"findCursorPosition",(function(t){for(var n=0,r={},o=0;o<e.textareaRow.length;o++){if(t-n<e.textareaRow[o].length){r.line=o,r.pos=t-n;break}n+=e.textareaRow[o].length}return r})),x(this,"saveSelect",(function(t,n){var r=Math.min(t,n),o=Math.max(t,n),i=e.textareaContent.slice(r,o);e.buffer.push(i)})),x(this,"cutSelect",(function(t,n){var r=Math.min(t,n),o=Math.max(t,n),i=e.textareaContent.slice(r,o);e.buffer.push(i),e.textareaContent=e.textareaContent.slice(0,r)+e.textareaContent.slice(o),e.textareaRow=e.prepareTextareaRow(e.textareaContent);var c=e.findCursorPosition(r);e.cursor=w({number:r},c)})),this.textareaContent="",this.textareaRow=[],this.cursor={line:0,pos:0,number:0},this.maxRowLength=77,this.buffer=new d,this.selectPosition=null}var e,n;return e=t,(n=[{key:"addSymbol",value:function(t){var e=this.cursor,n=(e.line,e.pos,e.number);if(n===this.textareaContent.length){var r=this.textareaContent+t;this.textareaContent=r,this.textareaRow=this.prepareTextareaRow(this.textareaContent);var o=this.findCursorPosition(n+t.length);this.cursor=w({number:n+t.length},o)}else{this.textareaContent=this.textareaContent.slice(0,n)+t+this.textareaContent.slice(n),this.textareaRow=this.prepareTextareaRow(this.textareaContent);var i=this.findCursorPosition(n+t.length);this.cursor=w({number:n+t.length},i)}}},{key:"deleteSymbol",value:function(t){var e=this.cursor,n=e.line,r=e.pos,o=e.number;if(o===this.textareaContent.length){if("prev"===t){var i=this.textareaContent.slice(0,-1);this.textareaContent=i,this.textareaRow=this.prepareTextareaRow(this.textareaContent),this.cursor={number:this.textareaContent.length,line:this.textareaRow.length-1,pos:this.textareaRow[this.textareaRow.length-1].length}}}else if("prev"===t){if(0!==o){this.textareaContent=this.textareaContent.slice(0,o-1)+this.textareaContent.slice(o),this.textareaRow=this.prepareTextareaRow(this.textareaContent);var c=this.findCursorPosition(o-1);this.cursor=w({number:o-1},c)}}else o<this.textareaContent.length&&(this.textareaContent=this.textareaContent.slice(0,o)+this.textareaContent.slice(o+1),this.textareaRow=this.prepareTextareaRow(this.textareaContent),this.cursor={number:o,line:n,pos:r})}},{key:"replaceSelect",value:function(t,e,n){var r=Math.min(t,e),o=Math.max(t,e);this.textareaContent=this.textareaContent.slice(0,r)+n+this.textareaContent.slice(o),this.textareaRow=this.prepareTextareaRow(this.textareaContent);var i=this.findCursorPosition(r+n.length);this.cursor=w({number:r+n.length},i)}}])&&g(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==S(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===S(o)?o:String(o)),r)}var o}var P=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.controller=e,this.editor=n,this.backupTextareaContent="",this.backupCursor={line:0,pos:0,number:0},this.textareaRow=[""],this.execute=function(){return r()}}var e,n;return e=t,(n=[{key:"saveBackup",value:function(){this.backupTextareaContent=this.editor.textareaContent,this.backupCursor=this.editor.cursor,this.textareaRow=this.editor.textareaRow}},{key:"undo",value:function(){this.editor=this.backupTextareaContent}}])&&j(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function R(t,e){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},R(t,e)}function T(t){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},T(t)}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&R(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=T(n);if(r){var o=T(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),n=o.call(this,t,e,(function(){return e.addSymbol(t.newSymbol),n.saveBackup(),!0}))}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(P);function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function B(t,e){return B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},B(t,e)}function L(t){return L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},L(t)}var D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&B(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=L(n);if(r){var o=L(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===E(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),n=o.call(this,t,e,(function(){return e.deleteSymbol(t.deleteDirection),n.saveBackup(),!0}))}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(P);function N(t){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N(t)}function K(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==N(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==N(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===N(o)?o:String(o)),r)}var o}var I=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.history=[e],this.activeCommandIndex=0}var e,n;return e=t,(n=[{key:"save",value:function(t){this.activeCommandIndex+=1,this.history.length>this.activeCommandIndex&&(this.history=this.history.slice(0,this.activeCommandIndex)),this.history[this.activeCommandIndex]=t}},{key:"back",value:function(){return 0!==this.activeCommandIndex&&(this.activeCommandIndex-=1,this.history[this.activeCommandIndex])}},{key:"next",value:function(){return this.activeCommandIndex+1!==this.history.length&&(this.activeCommandIndex+=1,this.history[this.activeCommandIndex])}}])&&K(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function M(t){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(t)}function F(t,e){return F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},F(t,e)}function A(t){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},A(t)}var H=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&F(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=A(n);if(r){var o=A(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===M(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,t,e,(function(){return e.saveSelect(t.selectedTextRange.start,t.selectedTextRange.end),!1}))}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(P);function J(t){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(t)}function U(t,e){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},U(t,e)}function V(t){return V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},V(t)}var X=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&U(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=V(n);if(r){var o=V(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===J(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),n=o.call(this,t,e,(function(){return e.replaceSelect(t.selectedTextRange.start,t.selectedTextRange.end,t.newSymbol),n.saveBackup(),!0}))}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(P);function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function Z(t,e){return Z=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Z(t,e)}function W(t){return W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},W(t)}var q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Z(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=W(n);if(r){var o=W(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),n=o.call(this,t,e,(function(){return e.cutSelect(t.selectedTextRange.start,t.selectedTextRange.end),n.saveBackup(),!0}))}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(P);function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function G(t,e){return G=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},G(t,e)}function Q(t){return Q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Q(t)}var $=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&G(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Q(n);if(r){var o=Q(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===z(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),n=o.call(this,t,e,(function(){return e.addSymbol(t.newSymbol),n.saveBackup(),!0}))}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(P);function tt(t){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(t)}function et(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==tt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==tt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===tt(o)?o:String(o)),r)}var o}var nt=function(){function t(e){var n=e.lang,r=void 0===n?"en":n,o=e.textareaContent,i=void 0===o?"":o,c=e.textareaRow,a=void 0===c?[""]:c,u=e.cursor,s=void 0===u?{number:0,line:0,pos:0}:u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.lang=r,this.textareaContent=i,this.textareaRow=a,this.cursor=s}var e,n;return e=t,n=[{key:"toJson",value:function(t){return JSON.stringify(t)}},{key:"instanceOfISourcesLStorage",value:function(t,e){return e in t}},{key:"fromJson",value:function(e){var n={};if(null===e||"object"!==tt(e))throw new Error("Not object in localstorage");return this.instanceOfISourcesLStorage(e,"lang")&&(n.lang=e.lang),this.instanceOfISourcesLStorage(e,"textareaContent")&&(n.textareaContent=e.textareaContent),this.instanceOfISourcesLStorage(e,"textareaRow")&&(n.textareaRow=e.textareaRow),this.instanceOfISourcesLStorage(e,"cursor")&&(n.cursor=e.cursor),new t(n)}}],null&&et(e.prototype,null),n&&et(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function rt(t){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rt(t)}function ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function it(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,at(r.key),r)}}function ct(t,e,n){return(e=at(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function at(t){var e=function(t,e){if("object"!==rt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==rt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===rt(e)?e:String(e)}var ut=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ct(this,"controlCombinations",[["Control","KeyX"],["Control","KeyC"],["Control","KeyV"],["Control","KeyZ"],["Control","KeyY"],["Control","Shift"]]),ct(this,"excludeKey",["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"]),ct(this,"toLocalStorageData",(function(t){localStorage.setItem("virtual_keyboard_by_Mi",nt.toJson(t))})),ct(this,"getLocalStorageData",(function(){try{return nt.fromJson(JSON.parse(localStorage.getItem("virtual_keyboard_by_Mi")||""))}catch(t){return new nt}})),ct(this,"hasActiveShift",(function(){var t=Object.keys(n.activeControls).filter((function(t){return 0!==n.activeControls[t]}));return 1===t.length&&(t.includes("ShiftLeft")||t.includes("ShiftRight"))})),ct(this,"symbol",(function(t,e){var r,o=e.value,i=e.value_shift;r=t.includes("Key")?n.hasActiveShift()&&!n.store.capsLock||!n.hasActiveShift()&&n.store.capsLock?i:o:n.hasActiveShift()?i:o,n.add(r)})),ct(this,"delete",(function(t,e){e.value,n.deleteDirection="Backspace"===t?"prev":"next",n.editor.textareaContent=n.store.textareaContent,n.editor.textareaRow=n.store.textareaRow,n.editor.cursor=n.store.cursor,n.executeCommand(new D(n,n.editor)),n.store.textareaContent=n.editor.textareaContent,n.store.textareaRow=n.editor.textareaRow,n.store.cursor=n.editor.cursor,n.deleteDirection=null})),ct(this,"space",(function(t,e){var r=e.value;n.add(r)})),ct(this,"capsLock",(function(t,e){e.value;var r=n.store.capsLock;n.store.capsLock=!r})),ct(this,"moveCursor",(function(t){var e=t.slice(5).toLowerCase();if(n.isSelectedText){var r=Math.min(n.selectedTextRange.start,n.selectedTextRange.end),o=Math.max(n.selectedTextRange.start,n.selectedTextRange.end);if(n.editor.textareaContent=n.store.textareaContent,n.editor.textareaRow=n.store.textareaRow,n.editor.cursor=n.store.cursor,n.editor.setCursorPosition("left"===e||"up"===e?r:o),n.store.cursor=n.editor.cursor,n.isSelectedText=!1,n.isCopiedText=!1,n.selectedTextRange=null,"left"===e||"right"===e)return!0}return n.cursorHandler[e](),!0})),ct(this,"add",(function(t){if(n.newSymbol=t,n.isSelectedText)return n.editor.textareaContent=n.store.textareaContent,n.editor.textareaRow=n.store.textareaRow,n.editor.cursor=n.store.cursor,n.executeCommand(new X(n,n.editor)),n.store.textareaContent=n.editor.textareaContent,n.store.textareaRow=n.editor.textareaRow,n.store.cursor=n.editor.cursor,n.isSelectedText=!1,n.isCopiedText=!1,n.selectedTextRange=null,void(n.newSymbol="");n.editor.textareaContent=n.store.textareaContent,n.editor.textareaRow=n.store.textareaRow,n.editor.cursor=n.store.cursor,n.executeCommand(new k(n,n.editor)),n.store.textareaContent=n.editor.textareaContent,n.store.textareaRow=n.editor.textareaRow,n.store.cursor=n.editor.cursor,n.newSymbol=""})),ct(this,"mouseDown",(function(t,e){var r=n.store.lang[n.store.langIndex],o=n.store.getKeyContent(t),i=o.type;"control"===i?n.lastControl.id&&n.lastControl.id===t&&n.lastControl.time&&e-n.lastControl.time<300?(n.activeControls[t]=1,n.activeBtns[t]=1,n.lastKey=t):n.hasControls()?n.activeControls[t]?(n.activeControls[t]=0,n.activeBtns[t]=1,n.lastKey=t,n.lastControl={id:null,time:null}):n.hasControlCombination(t)?(n.resetControls(),n.lastControl={id:null,time:null},n.activeBtns[t]=1,n.lastKey=t):(n.activeControls[t]=0,n.activeBtns[t]=1,n.lastKey=t,n.lastControl={id:t,time:e}):(n.lastControl={id:t,time:e},n.activeBtns[t]=1,n.lastKey=t):n.hasControls()?n.hasControlCombination(t)?(n.resetControls(),n.lastControl={id:null,time:null},n.lastKey=t,n.activeBtns[t]=1):("meta"!==i&&n.editMap[i]&&n.editMap[i](t,o[r]),n.resetControls(),n.lastControl={id:null,time:null},n.lastKey=t,n.activeBtns[t]=1):(n.lastControl={id:null,time:null},n.lastKey=t,n.activeBtns[t]=1,"meta"!==i&&n.editMap[i]&&n.editMap[i](t,o[r])),n.store.activeBtns=n.activeBtns})),ct(this,"mouseUp",(function(t,e){n.store.lang[n.store.langIndex];var r=n.store.getKeyContent(t).type;if(n.activeBtns=n.store.activeBtns,n.lastKey===t)if(n.hasControls())0===n.activeControls[t]&&(n.activeBtns[t]=0),n.lastKey=null;else for(var o=Object.keys(n.activeBtns),i=0;i<o.length;i+=1)n.activeBtns[o[i]]=0;else if(null!==n.lastKey)if(n.hasControls())0===n.activeControls[n.lastKey]&&(n.activeBtns[n.lastKey]=0),n.lastKey=null;else for(var c=Object.keys(n.activeBtns),a=0;a<c.length;a+=1)n.activeBtns[c[a]]=0;n.store.activeBtns=n.activeBtns,"control"!==r&&"capslock"!==r&&"meta"!==r&&n.isSelectedText&&!n.isCopiedText&&(n.isSelectedText=!1)})),ct(this,"resetControls",(function(){n.activeControls={}})),ct(this,"hasControls",(function(){return 0!==Object.keys(n.activeControls).filter((function(t){return 0!==n.activeControls[t]})).length})),ct(this,"keyDown",(function(t){if(!n.excludeKey.includes(t)){var e=n.store.lang[n.store.langIndex],r=n.store.getKeyContent(t);if(r){var o=r.type;n.activeBtns=n.store.activeBtns,"control"===o?(n.hasControls()||(n.activeControls[t]=1,n.activeBtns[t]=1),n.hasControls()&&(n.activeControls[t]||n.hasControlCombination(t)||(n.activeControls[t]=1),n.activeBtns[t]=1)):n.hasControls()?(n.hasControlCombination(t)||("meta"!==o&&n.editMap[o]?n.editMap[o](t,r[e]):n.isSelectedText&&(n.isSelectedText=!1,n.isCopiedText=!1,n.setCursorFromTextarea(n.selectedTextRange.end),n.store.cursor=n.editor.cursor,n.selectedTextRange=null,n.isSelectedText=!1,n.isCopiedText=!1)),n.activeBtns[t]=1):(n.activeBtns[t]=1,"meta"!==o&&n.editMap[o]?n.editMap[o](t,r[e]):n.isSelectedText&&(n.isSelectedText=!1,n.isCopiedText=!1,n.setCursorFromTextarea(n.selectedTextRange.end),n.store.cursor=n.editor.cursor,n.selectedTextRange=null,n.isSelectedText=!1,n.isCopiedText=!1)),n.store.activeBtns=n.activeBtns}else n.isSelectedText&&(n.isSelectedText=!1,n.isCopiedText=!1,n.setCursorFromTextarea(n.selectedTextRange.end),n.store.cursor=n.editor.cursor,n.selectedTextRange=null,n.isSelectedText=!1,n.isCopiedText=!1)}})),ct(this,"keyUp",(function(t){if(!n.excludeKey.includes(t)){n.store.lang[n.store.langIndex];var e=n.store.getKeyContent(t);if(e){var r=e.type;if(n.activeBtns=n.store.activeBtns,n.hasControls())n.activeBtns[t]=0,1===n.activeControls[t]&&(n.activeControls[t]=0);else{1===n.activeControls[t]&&(n.activeControls[t]=0);for(var o=Object.keys(n.activeBtns),i=0;i<o.length;i+=1)n.activeBtns[o[i]]=0}n.store.activeBtns=n.activeBtns,"control"!==r&&"capslock"!==r&&"meta"!==r&&n.isSelectedText&&!n.isCopiedText&&(n.isSelectedText=!1)}else n.isSelectedText&&(n.isSelectedText=!1,n.isCopiedText=!1,n.setCursorFromTextarea(n.selectedTextRange.end),n.store.cursor=n.editor.cursor,n.selectedTextRange=null,n.isSelectedText=!1,n.isCopiedText=!1)}})),ct(this,"upCursor",(function(){var t=n.store.cursor,e=t.line,r=t.pos,o=(t.number,n.store.textareaRow);if(0!==e){var i=e-1,c=0;if(i>0)for(var a=0;a<i;a++)c+=o[a].length;o[i].length>r?(c+=r,n.store.cursor={number:c,line:i,pos:r}):(c+=o[i].length-1,n.store.cursor={number:c,line:i,pos:o[i].length-1})}})),ct(this,"downCursor",(function(){var t=n.store.cursor,e=t.line,r=t.pos,o=(t.number,n.store.textareaRow);if(e!==o.length-1){for(var i=e+1,c=0,a=0;a<i;a++)c+=o[a].length;if(o[i].length>r)c+=r,n.store.cursor={number:c,line:i,pos:r};else{c+=o[i].length-1;var u=o[i].length-1;n.store.cursor={number:c,line:i,pos:u}}}})),ct(this,"leftCursor",(function(){var t=n.store.cursor,e=t.line,r=t.pos,o=t.number,i=n.store.textareaRow;if(0!==r||0!==e)if(r-1==0){var c=0;if(0!==e)for(var a=0;a<e;a++)c+=i[a].length;n.store.cursor={number:c,line:e,pos:0}}else if(0===r){for(var u=0,s=e-1,l=0;l<e;l++)u+=i[l].length;n.store.cursor={number:u-1,line:s,pos:i[s].length-1}}else{var f=o-1,p=r-1;n.store.cursor={number:f,line:e,pos:p}}})),ct(this,"rightCursor",(function(){var t=n.store.cursor,e=t.line,r=t.pos,o=t.number,i=n.store.textareaRow;o!==n.store.textareaContent.length&&(r+1===i[e].length?n.store.cursor={number:o+1,line:e+1,pos:0}:n.store.cursor={number:o+1,line:e,pos:r+1})})),ct(this,"setCursorFromTextarea",(function(t){n.editor.textareaContent=n.store.textareaContent,n.editor.textareaRow=n.store.textareaRow,n.editor.cursor=n.store.cursor,n.editor.setCursorPosition(t),n.store.cursor=n.editor.cursor,n.isSelectedText&&(n.selectedTextRange=null,n.isSelectedText=!1,n.isCopiedText=!1)})),ct(this,"selectTextRange",(function(t,e){n.selectedTextRange&&(n.selectedTextRange=null),n.selectedTextRange={start:t,end:e},n.isSelectedText=!0})),ct(this,"editMap",{symbol:this.symbol,delete:this.delete,move:this.moveCursor,capslock:this.capsLock,space:this.space}),ct(this,"textareaHandler",{setCursorPosition:this.setCursorFromTextarea,selectTextRange:this.selectTextRange}),ct(this,"cursorHandler",{up:this.upCursor,down:this.downCursor,left:this.leftCursor,right:this.rightCursor}),ct(this,"keyHandler",{mouseDown:this.mouseDown,mouseUp:this.mouseUp}),ct(this,"boardHandler",{keyHandler:this.keyHandler}),ct(this,"initKeyboard",(function(t){var e={};t.forEach((function(t){e["".concat(t.code)]=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(n),!0).forEach((function(e){ct(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t)})),n.store.setInitState({keys:e,langIndex:n.store.lang.indexOf(n.localStorageData.lang)})})),this.store=e,this.editor=new C,this.history=new I({backupTextareaContent:"",backupCursor:{line:0,pos:0,number:0},backupTextareaRow:[""]}),this.localStorageData=this.getLocalStorageData(),this.activeBtns={},this.lastControl={id:null,time:null},this.activeControls={},this.lastKey=null,this.newSymbol=null,this.selectedTextRange=null,this.store.onChangeLocalStorageData.add((function(t){return n.toLocalStorageData(t)}))}var e,n;return e=t,(n=[{key:"hasControlCombination",value:function(t){var e=this,n=Object.keys(this.activeControls).filter((function(t){return 0!==e.activeControls[t]}));n.push(t);for(var r=n.map((function(t){return"ShiftLeft"===t||"ShiftRight"===t?"Shift":"AltLeft"===t||"AltRight"===t?"Alt":"ControlLeft"===t||"ControlRight"===t?"Control":t})),o=0;o<this.controlCombinations.length;o+=1)if(this.controlCombinations[o].every((function(t){return r.includes(t)}))){if("ControlShift"===this.controlCombinations[o].join("")){var i=this.store.langIndex;this.store.langIndex=(i+1)%this.store.lang.length}if("ControlKeyZ"===this.controlCombinations[o].join("")){this.isSelectedText&&(this.isSelectedText=!1,this.isCopiedText=!1,this.selectedTextRange=null);var c=this.history.back();c&&(this.store.textareaContent=c.backupTextareaContent,this.store.cursor=c.backupCursor,this.store.textareaRow=c.textareaRow)}if("ControlKeyY"===this.controlCombinations[o].join("")){this.isSelectedText&&(this.isSelectedText=!1,this.isCopiedText=!1,this.selectedTextRange=null);var a=this.history.next();a&&(this.store.textareaContent=a.backupTextareaContent,this.store.cursor=a.backupCursor,this.store.textareaRow=a.textareaRow)}if("ControlKeyX"===this.controlCombinations[o].join("")&&this.isSelectedText&&(this.editor.textareaContent=this.store.textareaContent,this.editor.selectPosition=this.selectedTextRange,this.executeCommand(new q(this,this.editor)),this.store.textareaContent=this.editor.textareaContent,this.store.textareaRow=this.editor.textareaRow,this.store.cursor=this.editor.cursor,this.isSelectedText=!1,this.isCopiedText=!1,this.selectedTextRange=null),"ControlKeyV"===this.controlCombinations[o].join("")){if(this.newSymbol=this.editor.buffer.getLast(),this.editor.textareaContent=this.store.textareaContent,this.editor.textareaRow=this.store.textareaRow,this.editor.cursor=this.store.cursor,this.isSelectedText)return this.executeCommand(new X(this,this.editor)),this.store.textareaContent=this.editor.textareaContent,this.store.textareaRow=this.editor.textareaRow,this.store.cursor=this.editor.cursor,this.isSelectedText=!1,this.isCopiedText=!1,void(this.selectedTextRange=null);this.executeCommand(new $(this,this.editor)),this.store.textareaContent=this.editor.textareaContent,this.store.textareaRow=this.editor.textareaRow,this.store.cursor=this.editor.cursor,this.isSelectedText=!1,this.isCopiedText=!1,this.selectedTextRange=null,this.newSymbol=""}return"ControlKeyC"===this.controlCombinations[o].join("")&&this.isSelectedText&&(this.editor.textareaContent=this.store.textareaContent,this.executeCommand(new H(this,this.editor)),this.isCopiedText=!0),this.controlCombinations[o]}return null}},{key:"executeCommand",value:function(t){t.execute()&&this.history.save(t)}}])&&it(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function st(t){return st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},st(t)}function lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==st(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==st(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===st(o)?o:String(o)),r)}var o}var ft=function(){function t(e){var n=e.parent,r=void 0===n?null:n,o=e.tagName,i=void 0===o?"div":o,c=e.className,a=void 0===c?"":c,u=e.content,s=void 0===u?"":u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var l=document.createElement(i);l.classList=a,l.innerHTML=s,r&&r.append(l),this.node=l}var e,n;return e=t,(n=[{key:"destroy",value:function(){this.node.remove()}}])&&lt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function pt(t){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pt(t)}function yt(t,e){return yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},yt(t,e)}function bt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ht(t){return ht=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ht(t)}function dt(t){var e=function(t,e){if("object"!==pt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===pt(e)?e:String(e)}var mt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yt(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ht(n);if(r){var o=ht(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===pt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return bt(t)}(this,t)});function i(t){var e,n,r,c,a=t.parent,u=t.className,s=t.lang,l=t.controller;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),n=bt(e=o.call(this,{parent:a,tagName:"header",className:"".concat(u,"__header header")})),c=function(t){e.activeLang=t,e.lang.node.textContent=e.activeLang},(r=dt(r="onChangeLang"))in n?Object.defineProperty(n,r,{value:c,enumerable:!0,configurable:!0,writable:!0}):n[r]=c,e.controller=l,e.activeLang=s,e.container=new ft({parent:e.node,className:"header__container container"}),e.lang=new ft({parent:e.container.node,className:"header__lang lang",content:e.activeLang}),e.description=new ft({parent:e.container.node,className:"header__description description",content:"\n        <span>Virtual Keyboard реализована для Window OS</span>\n        <span>Для зажатия контрольной кнопки используйте двойной клик</span>\n      "}),e}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(ft);function vt(t){return vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vt(t)}function wt(t,e){return wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},wt(t,e)}function gt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xt(t){return xt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xt(t)}function Ot(t){var e=function(t,e){if("object"!==vt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==vt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===vt(e)?e:String(e)}var Ct=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wt(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=xt(n);if(r){var o=xt(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===vt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return gt(t)}(this,t)});function i(t){var e,n,r,c,a=t.parent,u=t.className,s=t.controller;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),n=gt(e=o.call(this,{parent:a,tagName:"textarea",className:"".concat(u,"__textarea textarea")})),c=function(t){e.node.textContent=t,e.node.focus()},(r=Ot(r="setContent"))in n?Object.defineProperty(n,r,{value:c,enumerable:!0,configurable:!0,writable:!0}):n[r]=c,e.controller=s,e.node.addEventListener("keydown",(function(t){t.preventDefault()})),e.node.addEventListener("keyup",(function(t){t.preventDefault()})),e.node.focus(),e.node.onmouseup=function(t){e.node.selectionEnd===e.node.selectionStart?e.controller.setCursorPosition(e.node.selectionEnd):e.controller.selectTextRange(e.node.selectionStart,e.node.selectionEnd)},e}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(ft);function St(t){return St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},St(t)}function jt(t,e){return jt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},jt(t,e)}function Pt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _t(t){return _t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_t(t)}function Rt(t){var e=function(t,e){if("object"!==St(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==St(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===St(e)?e:String(e)}var Tt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jt(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=_t(n);if(r){var o=_t(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===St(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Pt(t)}(this,t)});function i(t){var e,n,r,c,a=t.parent,u=t.className,s=t.code,l=t.content,f=t.controller;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),n=Pt(e=o.call(this,{parent:a,tagName:"button",className:"".concat(u,"__btn btn ").concat(s)})),c=function(t){e.content!==t&&(e.content=t),e.mainContent.node.textContent=e.content[0],e.beforeContent.node.textContent="".concat(2===e.content.length?e.content[1]:"")},(r=Rt(r="update"))in n?Object.defineProperty(n,r,{value:c,enumerable:!0,configurable:!0,writable:!0}):n[r]=c,e.code=s,e.content=l,e.controller=f,e.node.tabIndex="-1",e.beforeContent=new ft({parent:e.node,tagName:"span",className:"btn__content btn__content--before"}),e.mainContent=new ft({parent:e.node,tagName:"span",className:"btn__content btn__content--main"}),e.update(e.content),e.node.onmousedown=function(t){t.preventDefault(),e.controller.mouseDown(e.code,t.timeStamp),e.node.onmouseover=function(t){return e.node.onmouseup(t)}},e.node.onmouseup=function(t){e.controller.mouseUp(e.code,t.timeStamp),e.node.onmouseover=null},e}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(ft);function kt(t){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kt(t)}function Et(t,e){return Et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Et(t,e)}function Bt(t){return Bt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Bt(t)}var Lt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Et(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Bt(n);if(r){var o=Bt(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===kt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t){var e=t.parent,n=t.className,r=t.code,c=t.content,a=t.controller;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,{parent:e,className:n,code:r,content:c,controller:a})}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(Tt);function Dt(t){return Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dt(t)}function Nt(t,e){return Nt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Nt(t,e)}function Kt(t){return Kt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Kt(t)}var It=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nt(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Kt(n);if(r){var o=Kt(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Dt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t){var e=t.parent,n=t.className,r=t.code,c=t.content,a=t.controller;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,{parent:e,className:n,code:r,content:c,controller:a})}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(Tt);function Mt(t){return Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mt(t)}function Ft(t,e){return Ft=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ft(t,e)}function At(t){return At=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},At(t)}var Ht=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ft(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=At(n);if(r){var o=At(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Mt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t){var e=t.parent,n=t.className,r=t.code,c=t.content,a=t.controller;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,{parent:e,className:n,code:r,content:c,controller:a})}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(Tt);function Jt(t){return Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jt(t)}function Ut(t,e){return Ut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ut(t,e)}function Vt(t){return Vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Vt(t)}var Xt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ut(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Vt(n);if(r){var o=Vt(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Jt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t){var e=t.parent,n=t.className,r=t.code,c=t.content,a=t.controller;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,{parent:e,className:n,code:r,content:c,controller:a})}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(Tt);function Yt(t){return Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yt(t)}function Zt(t,e){return Zt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Zt(t,e)}function Wt(t){return Wt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Wt(t)}var qt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zt(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Wt(n);if(r){var o=Wt(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Yt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t){var e=t.parent,n=t.className,r=t.code,c=t.content,a=t.controller;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,{parent:e,className:n,code:r,content:c,controller:a})}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(Tt);function zt(t){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zt(t)}function Gt(t,e){return Gt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Gt(t,e)}function Qt(t){return Qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qt(t)}var $t=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gt(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Qt(n);if(r){var o=Qt(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===zt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t){var e=t.parent,n=t.className,r=t.code,c=t.content,a=t.controller;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,{parent:e,className:n,code:r,content:c,controller:a})}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(Tt);function te(t){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(t)}function ee(t,e){return ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ee(t,e)}function ne(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function re(t){return re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},re(t)}function oe(t,e,n){return(e=ie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ie(t){var e=function(t,e){if("object"!==te(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==te(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===te(e)?e:String(e)}var ce={ShiftLeft:$t,ShiftRight:$t,ControlLeft:Xt,ControlRight:Xt,MetaLeft:qt,AltLeft:Lt,AltRight:Lt,ArrowLeft:It,ArrowRight:It,CapsLook:Ht},ae=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ee(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=re(n);if(r){var o=re(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===te(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ne(t)}(this,t)});function i(t){var e,n=t.parent,r=t.className,c=t.lang,a=t.controller;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),oe(ne(e=o.call(this,{parent:n,className:"".concat(r,"__board board")})),"onChangeLang",(function(t){e.lang=t,Object.keys(e.btns).forEach((function(t,n){e.btns[t].update(e.keys[t]["".concat(e.lang)].name)}))})),oe(ne(e),"init",(function(t){var n=t.keys,r=t.lang;e.lang=r,e.keys=n,Object.keys(e.keys).forEach((function(t,n){var r=e.keys[t],o=r.row,i=r.code,c=ce[i]||Tt;e.btns[i]=new c({parent:e.rows[o-1].node,className:"board",code:i,content:r["".concat(e.lang)].name,controller:e.controller.keyHandler})}))})),e.lang=c,e.controller=a,e.rows={},e.keys={},e.btns={};for(var u=0;u<5;u+=1)e.rows[u]=new ft({parent:e.node,className:"board__row row"});return e}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(ft);function ue(t){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ue(t)}function se(t,e){return se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},se(t,e)}function le(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fe(t){return fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fe(t)}function pe(t,e,n){return(e=ye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ye(t){var e=function(t,e){if("object"!==ue(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ue(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===ue(e)?e:String(e)}var be=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&se(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=fe(n);if(r){var o=fe(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===ue(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return le(t)}(this,t)});function i(t){var e,n=t.parent,r=t.className,c=t.controller;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),pe(le(e=o.call(this,{parent:n,tagName:"main",className:"".concat(r,"__main main")})),"setFocusOnTextarea",(function(){return e.textarea.node.focus()})),pe(le(e),"init",(function(t){e.board.init(t)})),pe(le(e),"onChangeLang",(function(t){e.board.onChangeLang(t)})),pe(le(e),"onChangeTextareaContent",(function(t){e.textarea.setContent(t)})),pe(le(e),"onChangeCursorPosition",(function(t){var n=t.start,r=t.end;e.textarea.node.setSelectionRange(n,r)})),pe(le(e),"onInitState",(function(t){var n=t.keys,r=t.lang;e.board.init({keys:n,lang:r})})),e.controller=c,e.container=new ft({parent:e.node,className:"main__container container"}),e.textarea=new Ct({parent:e.container.node,className:r,controller:c.textareaHandler}),e.board=new ae({parent:e.container.node,className:r,lang:"en",controller:e.controller.boardHandler}),e}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(ft);function he(t){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},he(t)}function de(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==he(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==he(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===he(o)?o:String(o)),r)}var o}var me=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data=[]}var e,n;return e=t,(n=[{key:"getKeysData",value:function(){var t=this;return fetch("./data/keys.json").then((function(t){return t.json()})).then((function(e){if(!Array.isArray(e))throw new Error("Data load error");return t.data=e,t.data}))}}])&&de(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ve(t){return ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ve(t)}function we(t,e){return we=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},we(t,e)}function ge(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xe(t){return xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xe(t)}function Oe(t){var e=function(t,e){if("object"!==ve(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ve(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===ve(e)?e:String(e)}var Ce,Se=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&we(t,e)}(i,t);var e,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=xe(n);if(r){var o=xe(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===ve(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ge(t)}(this,t)});function i(t){var e,n,r,c,a=t.parent,u=t.controller,s=t.store;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),n=ge(e=o.call(this,{parent:a,className:"keyboard"})),c=function(){(new me).getKeysData().then((function(t){e.data=t,e.controller.initKeyboard(e.data)}))},(r=Oe(r="init"))in n?Object.defineProperty(n,r,{value:c,enumerable:!0,configurable:!0,writable:!0}):n[r]=c,e.controller=u,e.store=s,e.data=[],e.keys=[],e.header=new mt({parent:e.node,className:"keyboard",lang:"en",controller:u}),e.main=new be({parent:e.node,className:"keyboard",controller:e.controller}),document.addEventListener("keydown",(function(t){return e.controller.keyDown(t.code)}),!0),document.addEventListener("keyup",(function(t){return e.controller.keyUp(t.code)}),!0),document.addEventListener("click",(function(){return e.main.setFocusOnTextarea()})),e.store.onChangeTextareaContent.add((function(t){return e.main.onChangeTextareaContent(t)})),e.store.onChangeLang.add((function(t){e.header.onChangeLang(t),e.main.onChangeLang(t)})),e.store.onChangeCursorPosition.add((function(t){return e.main.onChangeCursorPosition(t)})),e.store.onInitState.add((function(t){var n=t.keys,r=t.lang;e.header.onChangeLang(r),e.main.onInitState({keys:n,lang:r})})),e}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(ft),je=void new Se({parent:document.body,controller:new ut(Ce=new l),store:Ce}).init();window.keyboard=je})();
//# sourceMappingURL=index.js.map